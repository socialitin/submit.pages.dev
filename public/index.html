<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf8">
		<title>Cloudflare Pages | Form Demo</title>
		<meta name="theme-color" content="#d86300">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="viewport" content="width=device-width,initial-scale=1">
		<link rel="icon" type="image/png" href="https://www.cloudflare.com/favicon-128.png">
		<link rel="stylesheet" href="/index.css">
	</head>
	<body>

		<main>
			<h1> Form Submission</h1>

			<blockquote>
				<p>This is a demonstration of Cloudflare Pages with Functions.</p>
				<p>Pages deployed a <code>/public</code> directory, containing a HTML document (this webpage) and a <code>/functions</code> directory, which contains the Cloudflare Workers code for the API endpoint this <code>&lt;form&gt;</code> references.</p>
				<p><b>NOTE:</b> On form submission, the API endpoint responds with a JSON representation of the data. There is no JavaScript running in this example.</p>
			</blockquote>

			<form method="POST" action="/api/submit">
				<div class="input">
					<label for="name">Name of Product or Offer</label>
					<input id="name" name="name" type="text" />
				</div>

				<div class="input">
					<label for="email">URL </label>
					<input id="email" name="email" type="url" />
				</div>

				<div class="input">
					<label for="referers">Type/kind of offer</label>
					<select id="referers" name="referers">
						<option hidden disabled selected value></option>
						<option value="Sightseeing">Sightseeing</option>
						<option value="Excursion">Excursion</option>
						<option value="Night life">Night life</option>
						<option value="Walking tour">Walking tour</option>
						<option value="Water crusing">Water crusing</option>
					</select>
				</div>

				<div class="checklist">
					<label>Whats the venue</label>
					<ul>
						<li>
							<input id="m1" type="checkbox" name="venue" value="Attraction" />
							<label for="m1">Attraction</label>
						</li>
						<li>
							<input id="m2" type="checkbox" name="venue" value="Club" />
							<label for="m2">Club</label>
						</li>
						<li>
							<input id="m3" type="checkbox" name="venue" value="Accommodation" />
							<label for="m3">Accommodation</label>
						</li>
						<li>
							<input id="m4" type="checkbox" name="venue" value="Motorcoach" />
							<label for="m4">Motorcoach</label>
						</li>
					</ul>
				</div>
				<div class="input">
					<label for="pitch">Pitch!</label>
					<input id="pitch" name="pitch" type="textarea" />
				</div>

				<button type="submit">Submit</button>
			</form>
		</main>
<script>
	addEventListener('fetch', event => {
	event.respondWith(handleRequest(event.request))
	})
	
	async function handleRequest(request) {
	const url = new URL(request.url)
	const jsonUrl = 'https://pub-ff67a151dd104cf6b171f45a47c36526.r2.dev/NYCD.json' // Replace this with the URL of the R2 JSON file
	
	if (url.pathname === '/load-r2-json') {
	const response = await fetch(jsonUrl)
	const json = await response.json()
	
	return new Response(JSON.stringify(json), {
	headers: {
	'Content-Type': 'application/json'
	}
	})
	} else {
	return new Response('Not Found', { status: 404 })
	}
	}
</script>
	</body>
</html>
